# 14. Управление изменениями и внедрение

## 14.1. Пошаговая дорожная карта трансформации (roadmap)

**Фаза 0 — Подготовка (0–1 мес.)**

* Формирование целевой архитектуры и границ доменов (CRM, MasterDeal, Integration Layer, BI/DWH).
* Назначение **Change Sponsor**, **Product Owners** по доменам, создание **CCB** (Change Control Board).
* Бэклог трансформации: Epic’и → Capability → User stories; приоритезация по WSJF.
* План коммуникаций и обучения, матрица рисков/зависимостей, базовые KPI внедрения.

**Фаза 1 — Пилоты (2–3 мес.)**

* Пилот «Мастер-сделка» на ограниченном сегменте клиентов и 1–2 медиасегментах.
* Включение **каноничных бизнес-событий** (LeadCreated, DealQualified, MediaPlanApproved, IOIssued, LaunchStarted, BillingClosed) в шину событий.
* UAT, корректировки процессов, первичная миграция справочников.
* Метрики: Time-to-Launch, конверсия MQL→SQL→Deal, полнота событий.

**Фаза 2 — Волновой rollout (3–6 мес.)**

* Расширение по доменам и регионам: волна = «домен × сегмент клиентов».
* Переход на **канонизированный контракт интеграции** (event + API), отключение точек-точек.
* Параллельный учёт (old/new) по критическим SLA на 2–4 недели, затем cutover.

**Фаза 3 — Оптимизация и масштабирование (6–9 мес.)**

* Автоматизация узких мест: автогенерация медиапланов/КП, роботизация документооборота.
* Обогащение телеметрии (observability), A/B для LLM-сценариев, тонкая настройка SLA.
* Финальная миграция исторических данных, закрытие техдолга, ретроспектива.

**Фаза 4 — Закрепление (9–12 мес.)**

* Оценка эффекта: ROI, NPS, точность SLA, загрузка ролей.
* Институционализация практик: гайдбуки, онбординг, регулярные ревью CCB, процесс Continuous Improvement.

**Варианты cutover:**

* Big Bang (для узких контуров).
* Phased/Wave (рекомендуется): по доменам/клиентским сегментам.
* Strangler pattern для интеграций: постепенно «душим» легаси интерфейсы.

---

## 14.2. План внедрения по доменам

**Домен Sales (CRM):**

* Новые стадии pipeline, синхронизация с MasterDeal (статус «истина»).
* Каноничные события: LeadCreated, LeadQualified, OpportunityOpened/Closed.
* KPI: скорость квалификации, конверсия стадий, полнота контактов.

**Домен MasterDeal (Operational MasterDeal Service):**

* Модель агрегированного Stage (map из stage доменов → единый stage сделки).
* Правила консолидации статусов (source-of-truth + дедупликация), idempotency.
* KPI: целостность сделки, латентность апдейтов < X секунд, покрытие событий 100%.

**Домен Traffic / Media Planning:**

* Шаблоны медиапланов, калькуляторы сегментов, прайсинг.
* События: MediaPlanDrafted/Approved, InventoryReserved.
* KPI: время подготовки медиаплана, точность прогноза инвентаря.

**Домен Legal/Docflow:**

* E2E контракт: КП → договор → допсоглашения → закрывающие.
* События: IOIssued, ContractSigned, DocPackageCompleted.
* KPI: цикл согласования, процент эДО, SLA по юридическим блокам.

**Домен Финансы/Биллинг:**

* Связь факта запуска с биллингом, акты, сверки.
* События: LaunchStarted, BillingClosed.
* KPI: точность биллинга, время закрытия периода.

**Интеграционный слой (API Gateway + Event Bus):**

* Стандарты: версионирование API, схемы события (Avro/JSON Schema), DLQ, ретраи.
* Наблюдаемость: трассировка (trace-id = dealId), алерты по SLA.
* KPI: задержка доставки событий, % ошибок/ретраев, стабильность шины.

**DWH/BI/ML/LLM:**

* Слои данных: Raw → Canonical → Marts; lineage; качество данных (DQ чек-листы).
* Фичестор для моделей, offline/online scoring, A/B фреймворк для LLM.
* KPI: достоверность витрин, скорость обновления, uplift по автогенерации.

---

## 14.3. Обучение ролей и коммуникация изменений

**Ролевые учебные треки (минимум 2–4 ч на роль):**

* **Sales / Pre-sales:** новый pipeline, критерии ICP/BANT/CHAMP, работа с MasterDeal, создание качественных брифов.
* **Account:** статусы исполнения, единый Stage Dashboard, регламент эскалаций SLA.
* **Traffic-manager:** медиапланы, сегментирование, контроль инвентаря, события запуска.
* **Legal / Docflow:** шаблоны договоров, эДО, контроль полноты пакета, статусы IO.
* **ОКК / Контроль качества:** каноничные события, сверки, аудит изменений.
* **Ops/Support:** мониторинг интеграций, расследование инцидентов, DLQ/ретраи.
* **Data/BI/ML/LLM:** канонизация событий, схемы, фреймворки A/B, промт-гайдлайны.

**Форматы обучения:**

* Видеоуроки «короткими спринтами», интерактивные симуляторы в sandbox-окружении.
* Ролевые сценарии «как было/как стало», чек-листы «что делать при X».
* Сертификация по ролям (микро-экзамены), реестр FAQ, обновляемые плейбуки.

**Коммуникации:**

* **Каденс:** еженедельные апдейты (newsletter + стендапы доменов), демо-дни по итогам спринта.
* **Каналы:** корпоративный портал, Slack/Teams, единый портал изменений (release notes, дефекты, роадмап).
* **Обратная связь:** NPS по обучению, формы предложений, «office hours» с архитекторами/PO.

---

## 14.4. Управление рисками и зависимостями

**Категории рисков и меры:**

* **Организационные:** сопротивление изменениям, конфликт приоритетов.
  *Меры:* Sponsor-коммуникации, раннее вовлечение ключевых ролей, KPI на принятие.
* **Процессные:** несогласованность стадий между доменами.
  *Меры:* единый словарь стадий, CCB, тесты согласованности (contract & event tests).
* **Данные:** низкое качество и дубликаты, рассинхронизация «сырых» и «каноничных» событий.
  *Меры:* DQ-гейты, профилирование, мастер-идентификаторы, SLA на доставку событий.
* **Технические:** нестабильность шины, ретраи без идемпотентности, «шум» в DLQ.
  *Меры:* полиси ретраев с backoff, idempotency keys, алерты SLO, chaos-тесты.
* **Правовые/комплаенс:** ПДн, хранение и трассировка согласий.
  *Меры:* Data Protection Impact Assessment, шифрование, аудит, роль-бэйзд доступ.
* **LLM-специфичные:** галлюцинации, утечки промтов или данных.
  *Меры:* guardrails, контент-фильтры, red-teaming, human-in-the-loop на критических шагах.

**Реестр зависимостей (пример структуры):**

* *Upstream:* CRM (идентификаторы, контакты), каталоги сегментов, прайс-книги.
* *Downstream:* Docflow/Биллинг, BI/DWH, отчётность.
* *Кросс-функциональные:* Служба безопасности, IT-закупки, Legal.
* *Временные:* окна миграции, внешние кампании клиентов, фискальные периоды.

**Губернанс изменений:**

* **CCB**: принимает решения по scope/срокам/рискам, утверждает версии API/событий.
* **Change calendar:** единый календарь релизов и миграций, freeze-периоды.
* **Definition of Ready/Done:** для интеграций — контракт + схемы + тестовые события + мониторинг.
* **Контроль эффекта:** целевые KPI (см. главу 13) + KPI внедрения:
  — Адаптация: % активных пользователей, доля задач в новом контуре
  — Качество: падение инцидентов, полнота каноничных событий
  — Скорость: сокращение Time-to-Launch, времени согласований

**План гиперCARE (2–4 недели после cutover):**

* Расширенная первая линия, war-room по критическим инцидентам, ежедневные health-чек-поинты.
* Быстрые фиксы с «feature flags», отчёт о стабильности по итогам недели и закрывающий отчёт после фазы.
