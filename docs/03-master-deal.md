# **3. –ú–∞—Å—Ç–µ—Ä-—Å–¥–µ–ª–∫–∞**

---

## **3.1. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è**

**–ú–∞—Å—Ç–µ—Ä-—Å–¥–µ–ª–∫–∞ (MasterDeal)** ‚Äî —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç —Ü–∏—Ñ—Ä–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ä–µ–∫–ª–∞–º–Ω–æ–π –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ **adTech –ú–¢–° Stream**,
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–æ–±–æ–π **–µ–¥–∏–Ω—ã–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –æ–±—ä–µ–∫—Ç**, –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–π –¥–∞–Ω–Ω—ã–µ, —Å—Ç–∞—Ç—É—Å—ã –∏ —Å–æ–±—ã—Ç–∏—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤,
—É—á–∞—Å—Ç–≤—É—é—â–∏—Ö –≤ –∂–∏–∑–Ω–µ–Ω–Ω–æ–º —Ü–∏–∫–ª–µ —Ä–µ–∫–ª–∞–º–Ω–æ–π —Å–¥–µ–ª–∫–∏ ‚Äî –æ—Ç –ª–∏–¥–∞ –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏.

–ú–∞—Å—Ç–µ—Ä-—Å–¥–µ–ª–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–æ–ª—å **–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏**, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–¥–µ–ª–∫–∏
–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–æ–∑–¥–∞–≤–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è **—Å–∫–≤–æ–∑–Ω–æ–≥–æ SLA-–∫–æ–Ω—Ç—Ä–æ–ª—è, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏**.

---

## **3.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Ä–æ–ª—å**

–í –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞ **MasterDeal** —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ –≤–∏–¥–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ ‚Äî
**Operational MasterDeal Service**, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –≤ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã
–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–æ –≤—Å–µ–º–∏ –ø—Ä–µ–¥–º–µ—Ç–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏ —á–µ—Ä–µ–∑ **Integration Platform** (—à–∏–Ω—É —Å–æ–±—ã—Ç–∏–π –∏ API-—à–ª—é–∑).

```mermaid
graph TD
  subgraph MD[Operational MasterDeal Service]
    MDL[(MasterDeal)]
  end

  subgraph DOMAINS[–ü—Ä–µ–¥–º–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã]
    CRM[CRM]
    TT[Task-Tracker]
    MP[MediaPush]
    DOC[Docflow]
    LEG[Legal]
    DCM[Billing]
    DWH[DWH/BI]
  end

  CRM -- events/api --> MDL
  TT -- events/api --> MDL
  MP -- events/api --> MDL
  DOC -- events/api --> MDL
  LEG -- events/api --> MDL
  DCM -- events/api --> MDL
  MDL -- canonical events --> DWH
```

MasterDeal —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–∞–∫ **–º–µ—Ç–∞-–¥–æ–º–µ–Ω**, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Å–¥–µ–ª–∫–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏,
–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π REST- –∏ —Å–æ–±—ã—Ç–∏–π–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## **3.3. –ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å**

**MasterDeal** –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–¥–µ–ª–∫—É –∫–∞–∫ —Ü–µ–ª–æ—Å—Ç–Ω—ã–π –±–∏–∑–Ω–µ—Å-–æ–±—ä–µ–∫—Ç, –≤–∫–ª—é—á–∞—é—â–∏–π –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è           | –ü—Ä–∏–º–µ—Ä—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤                                                   | –ò—Å—Ç–æ—á–Ω–∏–∫             |
| ------------------- | ------------------------------------------------------------------- | -------------------- |
| –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã      | `master_deal_id`, `crm_deal_id`, `contract_id`, `invoice_id`        | CRM, Docflow, DCM    |
| –ö–ª–∏–µ–Ω—Ç –∏ –∫–æ–Ω—Ç–∞–∫—Ç    | `master_client_id`, `client_name`, `segment`, `industry`            | CRM                  |
| –§–∏–Ω–∞–Ω—Å—ã             | `budget_total`, `budget_media`, `revenue_planned`, `revenue_actual` | CRM, DCM             |
| –î–æ–∫—É–º–µ–Ω—Ç—ã           | `contract_number`, `contract_date`, `doc_status`                    | Docflow              |
| –ú–µ–¥–∏–∞               | `mediaplan_id`, `campaign_id`, `kpi`                                | MediaPush            |
| –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã | `legal_flag`, `risk_level`, `review_status`                         | Legal                |
| SLA –∏ —ç—Ç–∞–ø—ã         | `aggregated_stage`, `gates[]`, `sla_breached`                       | –í—Å–µ –¥–æ–º–µ–Ω—ã           |
| –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏         | `sales_owner`, `account_owner`, `traffic_owner`                     | HR/CRM               |
| –°–æ–±—ã—Ç–∏—è –∏ –∞—É–¥–∏—Ç     | `events[]`, `correlation_id`, `timestamps`                          | Integration Platform |

---

## **3.4. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –º–∞—Å—Ç–µ—Ä-—Å–¥–µ–ª–∫–∏**

### **–≠—Ç–∞–ø—ã**

| –≠—Ç–∞–ø          | –£—Å–ª–æ–≤–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞                | –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏       |
| ------------- | ------------------------------- | ------------------------ |
| `draft`       | —Å–æ–∑–¥–∞–Ω –ª–∏–¥ / —Å–¥–µ–ª–∫–∞ –≤ CRM       | CRM                      |
| `briefed`     | –ø–æ–ª—É—á–µ–Ω –±—Ä–∏—Ñ –∫–ª–∏–µ–Ω—Ç–∞            | CRM                      |
| `planning`    | –º–µ–¥–∏–∞–ø–ª–∞–Ω –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ          | Task-Tracker / MediaPush |
| `offer_ready` | –º–µ–¥–∏–∞–ø–ª–∞–Ω —É—Ç–≤–µ—Ä–∂–¥—ë–Ω, –ö–ü –≥–æ—Ç–æ–≤–æ  | MediaPush / CRM          |
| `contracting` | –¥–æ–≥–æ–≤–æ—Ä –≤ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏          | Docflow / Legal          |
| `launching`   | –¥–æ–≥–æ–≤–æ—Ä –ø–æ–¥–ø–∏—Å–∞–Ω                | Docflow                  |
| `running`     | –∫–∞–º–ø–∞–Ω–∏—è –∑–∞–ø—É—â–µ–Ω–∞               | MediaPush                |
| `closing`     | –≤—ã—Å—Ç–∞–≤–ª–µ–Ω—ã —Å—á–µ—Ç–∞ / –∞–∫—Ç—ã         | DCM                      |
| `closed`      | –∞–∫—Ç –∑–∞–∫—Ä—ã—Ç–∏—è –∏ –æ–ø–ª–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω—ã | DCM                      |

–ö–∞–∂–¥—ã–π —ç—Ç–∞–ø —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **–Ω–∞–±–æ—Ä gate-—Ñ–ª–∞–≥–æ–≤** (–≤–æ—Ä–æ—Ç), –ø–æ—Å—Ç—É–ø–∞—é—â–∏—Ö –∏–∑ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π,
–∞ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `stage` –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∞–≤–∏–ª.

---

## **3.5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å**

MasterDeal Service –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –¥–æ–º–µ–Ω–∞–º–∏ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É **SOA + EDA**:

* **Event-driven (EDA):**
  –¥–æ–º–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø—É–±–ª–∏–∫—É—é—Ç —Å–æ–±—ã—Ç–∏—è `deal.created`, `mediaplan.ready`, `contract.signed`, `invoice.issued`,
  –∫–æ—Ç–æ—Ä—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ MasterDeal.
* **REST API:**
  —Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

    * `GET /masterdeal/{id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–¥–µ–ª–∫–∏;
    * `PATCH /masterdeal/{id}/stage` ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å stage (–≤ —Ä–∞–º–∫–∞—Ö –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏);
    * `POST /masterdeal/events` ‚Äî –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ;
    * `GET /masterdeal/{id}/timeline` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—é —Å–æ–±—ã—Ç–∏–π.

MasterDeal –ø—É–±–ª–∏–∫—É–µ—Ç **–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è** (`masterdeal.stage.changed`, `masterdeal.sla.updated`)
–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ downstream-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (BI, LLM, –û–ö–ö).

```mermaid
graph TB
  classDef pat fill:#ffffff,stroke:#94a3b8,stroke-dasharray:3 3

  subgraph Upstream Domains Suppliers
    CRM[CRM BC]:::pat
    MP[Media BC]:::pat
    DOC[Docflow BC]:::pat
    LEG[Legal BC]:::pat
    DCM[Billing BC]:::pat
    TT[Task-Tracker BC]:::pat
  end

  subgraph Meta / ACL
    MD[(MasterDeal Meta-BC\nACL: Canonical Events, REST Aggregation,\nStage Computation, Gate Rules)]
  end

  subgraph Downstream Consumers
    DWH[DWH / BI]:::pat
    LLM[LLM Service Layer]:::pat
    OKK[OKK / Quality]:::pat
  end

  %% Upstream -> ACL (—Ç–∏–ø —Å–≤—è–∑–∏)
  CRM -- "Published Language (deal.created,\noffer.approved)" --> MD
  MP -- "Published Language (mediaplan.ready,\ncampaign.started)" --> MD
  DOC -- "Customer/Supplier Contract\n(Open Host Service)" --> MD
  LEG -- "Customer/Supplier (legal.approved)" --> MD
  DCM -- "Published Language (invoice.issued,\ncloseout.completed)" --> MD
  TT -- "Conformist (SLA timers/updates)" --> MD

  %% ACL -> Downstream
  MD -- "Open Host Service (GET /masterdeal),\nCanonical Events (stage.changed)" --> DWH
  MD -- "Context Composition (JSON),\nPrompts with Business Facts" --> LLM
  MD -- "Aggregated SLA/Stage feed" --> OKK

```
---

## **3.6. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏**

| –°–∏—Å—Ç–µ–º–∞          | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ  | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö                       | –†–µ–∑—É–ª—å—Ç–∞—Ç                           |
| ---------------- | ------------ | -------------------------------- | ----------------------------------- |
| **CRM**          | ‚Üí MasterDeal | —Å–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏, –∫–ª–∏–µ–Ω—Ç, –±—é–¥–∂–µ—Ç  | –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç master_deal_id           |
| **Task-Tracker** | ‚Üí MasterDeal | —Å—Ç–∞—Ç—É—Å—ã –∑–∞–¥–∞—á –∏ SLA              | –∫–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤                     |
| **MediaPush**    | ‚Üî MasterDeal | –º–µ–¥–∏–∞–ø–ª–∞–Ω, KPI, —Å—Ç–∞—Ç—É—Å –∫–∞–º–ø–∞–Ω–∏–∏  | –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —ç—Ç–∞–ø—ã planning / running |
| **Docflow**      | ‚Üî MasterDeal | –¥–æ–≥–æ–≤–æ—Ä, –£–ü–î, —Å—Ç–∞—Ç—É—Å—ã –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è | —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–Ω–≥               |
| **Legal-ops**    | ‚Üî MasterDeal | —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏             | legal_ok, risk_level                |
| **DCM**          | ‚Üí MasterDeal | —Å—á–µ—Ç–∞, –≤—ã—Ä—É—á–∫–∞                   | –ø–µ—Ä–µ—Ö–æ–¥ –≤ closing / closed          |
| **DWH**          | ‚Üê MasterDeal | –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è             | –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å              |
| **LLM Layer**    | ‚Üî MasterDeal | –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–¥–µ–ª–∫–∏                  | –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ö–ü, –∞–Ω–∞–ª–∏–∑ –¥–æ–≥–æ–≤–æ—Ä–æ–≤      |

---

## **3.7. –§—É–Ω–∫—Ü–∏–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å MasterDeal**

1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å—é —Å–¥–µ–ª–∫–∏**
   ‚Äî –µ–¥–∏–Ω—ã–π `master_deal_id` –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤, —Ç–∞–±–ª–∏—Ü–∞ —Å–≤—è–∑–µ–π —Å `external_id`.
2. **–ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ —Å—Ç–∞–¥–∏–π**
   ‚Äî —Ä–∞—Å—á—ë—Ç `aggregated_stage` –ø–æ gate-—Ñ–ª–∞–≥–∞–º –∏–∑ —Å–æ–±—ã—Ç–∏–π.
3. **–°–∫–≤–æ–∑–Ω–æ–π SLA-–∫–æ–Ω—Ç—Ä–æ–ª—å**
   ‚Äî —Ñ–∏–∫—Å–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å—Ç–∞–¥–∏–π –∏ –º–µ—Ç—Ä–∏–∫ SLA.
4. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏**
   ‚Äî –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –ø—Ä–∏—ë–º–∫–∞ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π, –∂—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞.
5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM-—Å–µ—Ä–≤–∏—Å–∞–º–∏**
   ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–¥–µ–ª–∫–∏ (brief + offer + contract + status) –¥–ª—è AI-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏.
6. **–ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π**
   ‚Äî –µ–¥–∏–Ω—ã–π –ø–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è DWH, BI, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏.
7. **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Integration Platform**
   ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏, retries.

---

## **3.8. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö MasterDeal (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)**

```mermaid
erDiagram
  MASTER_DEAL {
    uuid master_deal_id PK
    string deal_name
    string stage
    uuid master_client_id
    numeric budget_total
    numeric revenue_actual
    boolean sla_breached
    timestamp opened_at
    timestamp closed_at
  }
  MD_LINK {
    uuid id PK
    uuid master_deal_id FK
    string system_code
    string external_id
  }
  MD_STATUS {
    uuid id PK
    uuid master_deal_id FK
    string domain
    string status_code
    timestamp status_at
  }
  MD_SLA {
    uuid master_deal_id PK
    interval lead_to_contract
    interval contract_to_launch
    boolean breached
  }
  MD_EVENT {
    uuid id PK
    uuid master_deal_id FK
    string event_type
    string source_system
    timestamp occurred_at
  }
  MASTER_DEAL ||--o{ MD_LINK : "—Å–≤—è–∑–∏ —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏"
  MASTER_DEAL ||--o{ MD_STATUS : "–¥–æ–º–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã"
  MASTER_DEAL ||--|| MD_SLA : "SLA"
  MASTER_DEAL ||--o{ MD_EVENT : "–∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π"
```

---

## **3.9. –°—Ç–∞—Ç—É—Å–Ω–∞—è –º–æ–¥–µ–ª—å –∏ SLA**

MasterDeal –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ö–µ–º—É –≤—ã—á–∏—Å–ª–µ–Ω–∏—è stage**:
–∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –Ω–∞–±–æ—Ä–∞ –¥–æ–º–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–∏–∫–∞—Ç–æ–≤ (gate-—Ñ–ª–∞–≥–æ–≤).
–≠—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é —Å—Ç–∞—Ç—É—Å–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –¥–µ–ª–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º–∏.

* –°—Ç–∞–¥–∏–∏: `draft ‚Üí briefed ‚Üí planning ‚Üí offer_ready ‚Üí contracting ‚Üí launching ‚Üí running ‚Üí closing ‚Üí closed`
* –¢–∞–π–º–µ—Ä—ã SLA –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–µ–∂–¥—É —Å—Ç–∞–¥–∏—è–º–∏.
* –ù–∞—Ä—É—à–µ–Ω–∏—è SLA –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ –≤–∏–¥–µ —Å–æ–±—ã—Ç–∏—è `masterdeal.sla.breached`.

---

## **3.10. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å LLM-—Å–µ—Ä–≤–∏—Å–∞–º–∏**

LLM-–º–æ–¥–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–¥–µ–ª–∫–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ:

```json
{
  "master_deal_id": "MDL-000234",
  "deal_name": "KION Q4 Performance",
  "client": { "master_client_id": "MCL-1029", "name": "KION", "industry": "Media" },
  "stage": "contracting",
  "priority": "high",
  "opened_at": "2025-09-14T10:22:11Z",
  "links": {
    "crm": { "id": "CRM-8823", "url": "https://crm/deal/8823" },
    "mediapush": { "mediaplan_id": "MP-447", "campaign_id": null },
    "docflow": { "contract_id": "DOC-571", "status": "in_review" },
    "dcm": { "invoice_id": null }
  },
  "finance": {
    "budget_total": 1200000.00,
    "budget_media": 950000.00,
    "services_cost": 120000.00,
    "revenue_planned": 1350000.00,
    "revenue_actual": 0.00,
    "currency": "RUB",
    "margin_pct": 0.125
  },
  "sla": {
    "lead_to_plan": "P2D06H",
    "plan_to_contract": "P1D12H",
    "contract_to_launch": null,
    "sla_breached": false,
    "breach_reasons": []
  },
  "roles": [
    { "role": "sales", "user_id": "u-101", "full_name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" },
    { "role": "account", "user_id": "u-202", "full_name": "–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞" },
    { "role": "traffic", "user_id": "u-303", "full_name": "–î–µ–Ω–∏—Å –û—Ä–ª–æ–≤" }
  ],
  "documents": [
    { "doc_type": "offer", "doc_id": "OFF-3391", "status": "approved" },
    { "doc_type": "contract", "doc_id": "DOC-571", "status": "in_review" }
  ],
  "media": [
    { "mediaplan_id": "MP-447", "status": "ready", "placements_count": 42, "kpi": { "reach": 4.3e6, "cpm": 210.5 } }
  ],
  "billing": [],
  "ai": [
    { "kind": "next_action", "severity": 2, "summary": "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä –Ω–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É." }
  ],
  "events": [
    { "event_type": "deal.created", "source_system": "crm", "occurred_at": "2025-09-14T10:22:11Z" },
    { "event_type": "mediaplan.ready", "source_system": "mediapush", "occurred_at": "2025-09-16T15:05:33Z" }
  ]
}

```

–°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

* –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–¥–∏–∞–ø–ª–∞–Ω–æ–≤ –ø–æ –±—Ä–∏—Ñ—É;
* —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π;
* –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –º–µ–¥–∏–∞–ø–ª–∞–Ω—É;
* –∞–Ω–∞–ª–∏–∑ SLA –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è Sales/Account.

---

## **3.11. –ü–æ–ª—å–∑–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞**

| –≠—Ñ—Ñ–µ–∫—Ç                        | –ö–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è                                               |
| ----------------------------- | ------------------------------------------------------------- |
| **–°–∫–≤–æ–∑–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**     | –í—Å–µ —ç—Ç–∞–ø—ã —Å–¥–µ–ª–∫–∏ –≤–∏–¥–Ω—ã –≤ –æ–¥–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ.                       |
| **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ Time-to-Launch** | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏.                      |
| **–ö–æ–Ω—Ç—Ä–æ–ª—å SLA**              | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å—Ç–∞–¥–∏–π.             |
| **–ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö**           | –ï–¥–∏–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.             |
| **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**             | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ LLM-—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —Ä–æ–±–æ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–¥–∏–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. |
| **–£–ø—Ä–∞–≤–ª—è–µ–º–æ—Å—Ç—å**             | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∞—É–¥–∏—Ç –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞.               |

---

## **3.12. –ë–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è MasterDeal: —Å—ã—Ä—ã–µ –∏ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ**

---

### **3.12.1. –†–æ–ª—å —Å–æ–±—ã—Ç–∏–π –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**

MasterDeal ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –∞–≥—Ä–µ–≥–∞—Ç –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –∏ **–∞–≥—Ä–µ–≥–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π**,
–∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –¥–æ–º–µ–Ω–æ–≤, –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏—Ö –∏ –ø—É–±–ª–∏–∫—É–µ—Ç –≤ –≤–∏–¥–µ **–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏–π**.

–¢–∞–∫ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –ø—Ä–∏–Ω—Ü–∏–ø **Event-Driven Architecture (EDA)**:
–∫–∞–∂–¥–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ, –∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π,
–≥–¥–µ **MasterDeal –≤—ã—Å—Ç—É–ø–∞–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–º –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–æ–º** –º–µ–∂–¥—É –¥–æ–º–µ–Ω–Ω—ã–º–∏ —è–∑—ã–∫–∞–º–∏.

---

### **3.12.2. –°—ã—Ä—ã–µ (Raw) –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è**

**–°—ã—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è** ‚Äî —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—É–±–ª–∏–∫—É–µ–º—ã–µ –ø—Ä–µ–¥–º–µ—Ç–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏ –≤ –∏—Ö ‚Äú—Ä–æ–¥–Ω–æ–º‚Äù —Ñ–æ—Ä–º–∞—Ç–µ.
–û–Ω–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –Ω–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ–¥ –æ–±—â—É—é —Å—Ö–µ–º—É.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

* —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏;
* –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è –∏ —Å—Ç–∞—Ç—É—Å—ã;
* –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ç–µ—Ä–º–∏–Ω–æ–≤ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏;
* —Å–ª—É–∂–∞—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ñ–∞–∫—Ç–æ–≤ –¥–ª—è MasterDeal.

#### –ü—Ä–∏–º–µ—Ä —Å—ã—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π:

| –ò—Å—Ç–æ—á–Ω–∏–∫      | –°–æ–±—ã—Ç–∏–µ                   | Payload (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)                                                                                |
| ------------- | ------------------------- | -------------------------------------------------------------------------------------------------- |
| **CRM**       | `crm.deal.created`        | `{ "deal_id": "CRM-1045", "client": "KION", "budget": 1200000, "sales_owner": "ivanov" }`          |
| **MediaPush** | `media.mediaplan.ready`   | `{ "mediaplan_id": "MP-301", "deal_ref": "CRM-1045", "channels": ["KION", "VK"], "reach": 3.2e6 }` |
| **Docflow**   | `docflow.contract.signed` | `{ "contract_id": "C-2024-101", "crm_deal_id": "CRM-1045", "signed_at": "2025-10-20" }`            |
| **DCM**       | `dcm.invoice.issued`      | `{ "invoice_id": "I-0002231", "contract_id": "C-2024-101", "sum": 1200000 }`                       |

–ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ö–µ–º—É (Schema Registry), topic –∏ TTL.
MasterDeal –Ω–µ –≤–º–µ—à–∏–≤–∞–µ—Ç—Å—è –≤ –∏—Ö —Ñ–æ—Ä–º–∞—Ç ‚Äî –æ–Ω **—á–∏—Ç–∞–µ—Ç, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç** –∏—Ö –≤ –µ–¥–∏–Ω—É—é –º–æ–¥–µ–ª—å.

---

### **3.12.3. –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ (Canonical) –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è**

**–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ** ‚Äî —ç—Ç–æ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ MasterDeal –ø—É–±–ª–∏–∫—É–µ—Ç
–ø–æ—Å–ª–µ –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Ö–æ–¥—è—â–∏—Ö —Å—ã—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π.

–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å —É—Å—Ç—Ä–∞–Ω—è–µ—Ç —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç downstream-—Å–∏—Å—Ç–µ–º–∞–º
(–Ω–∞–ø—Ä–∏–º–µ—Ä, DWH, LLM, –û–ö–ö, BI) –ø–æ–ª—É—á–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ,
–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

* —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö **MasterDeal Canonical Model**;
* –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç `master_deal_id`;
* –∏–º–µ—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã (`stage.changed`, `sla.updated`, `closed`);
* –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ –æ–±—â–∏–π topic: `masterdeal.events`.

#### –ü—Ä–∏–º–µ—Ä –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–±—ã—Ç–∏—è:

```json
{
  "event_type": "masterdeal.stage.changed",
  "master_deal_id": "MDL-00432",
  "aggregated_stage": "contracting",
  "source_events": [
    "crm.deal.created:CRM-1045",
    "docflow.contract.signed:C-2024-101"
  ],
  "payload": {
    "client": "KION",
    "budget_total": 1200000,
    "contract_id": "C-2024-101",
    "sales_owner": "ivanov",
    "legal_flag": "ok"
  },
  "timestamp": "2025-10-20T15:40:00Z",
  "sla": {
    "lead_to_contract": "P2D",
    "sla_breached": false
  },
  "published_by": "masterdeal-service"
}
```

---

### **3.12.4. –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è**

| –®–∞–≥ | –û–ø–∏—Å–∞–Ω–∏–µ                                                                       | –ü—Ä–∏–º–µ—Ä                     |
|-----| ------------------------------------------------------------------------------ | -------------------------- |
| 1   | MasterDeal –ø–æ–ª—É—á–∞–µ—Ç —Å—ã—Ä–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç –¥–æ–º–µ–Ω–∞ —á–µ—Ä–µ–∑ Kafka –∏–ª–∏ REST-webhook       | `media.mediaplan.ready`    |
| 2   | –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å–≤—è–∑—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `master_deal_id` (–ø–æ CRM-ID –∏–ª–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É) | `CRM-1045 ‚Üí MDL-00432`     |
| 3   | –û–±–Ω–æ–≤–ª—è–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è (`stage`, `gates`, `sla`)                        | `stage = "offer_ready"`    |
| 4   | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –ø—É–±–ª–∏–∫—É–µ—Ç **–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ**                                | `masterdeal.stage.changed` |
| 5   | DWH, BI, LLM –∏ –¥—Ä—É–≥–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –µ–≥–æ –∏–∑ –µ–¥–∏–Ω–æ–≥–æ topic                 | `masterdeal.events`        |

---

### **3.12.5. –ü—Ä–∏–º–µ—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è ‚Äú—Å—ã—Ä–æ–µ ‚Üí –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–µ‚Äù**

| –ò—Å—Ç–æ—á–Ω–∏–∫  | Raw event                 | Canonical event            | Stage         | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è      |
| --------- | ------------------------- | -------------------------- | ------------- | --------------------- |
| CRM       | `crm.deal.created`        | `masterdeal.created`       | `draft`       | –°–æ–∑–¥–∞–Ω–∏–µ MasterDeal   |
| CRM       | `crm.brief.submitted`     | `masterdeal.briefed`       | `briefed`     | –ù–∞—á–∞–ª–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è   |
| MediaPush | `media.mediaplan.ready`   | `masterdeal.stage.changed` | `offer_ready` | –ì–æ—Ç–æ–≤ –ö–ü              |
| Docflow   | `docflow.contract.signed` | `masterdeal.stage.changed` | `contracting` | –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞ |
| DCM       | `dcm.invoice.issued`      | `masterdeal.stage.changed` | `closing`     | –í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç–∞     |
| DCM       | `dcm.closeout.completed`  | `masterdeal.closed`        | `closed`      | –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏     |
| DWH       | `sla.breached`            | `masterdeal.sla.breached`  | *–ª—é–±–æ–π*       | SLA-—Å–æ–±—ã—Ç–∏–µ           |

---

### **3.12.6. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**

| –ê—Å–ø–µ–∫—Ç                             | –ü–æ–ª—å–∑–∞                                                                        |
| ---------------------------------- | ----------------------------------------------------------------------------- |
| **–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π**          | downstream-—Å–∏—Å—Ç–µ–º—ã –ø–æ–ª—É—á–∞—é—Ç –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –±–µ–∑ –∑–Ω–∞–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤               |
| **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** | MasterDeal –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Å–æ–±—ã—Ç–∏–π                  |
| **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Ä–º–∏–Ω–æ–≤**          | ‚Äúoffer_ready‚Äù –∑–Ω–∞—á–∏—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –¥–ª—è CRM, Media, Legal                       |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏**             | DWH –∏ LLM —Ä–∞–±–æ—Ç–∞—é—Ç —Å –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –∫–∞–∫ —Å –Ω–∞–¥—ë–∂–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ñ–∞–∫—Ç–æ–≤ |
| **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**                  | –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –¥–æ–º–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ downstream                  |

---


## **3.13 –†–æ–ª—å —Å–∏—Å—Ç–µ–º—ã MasterDeal –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Å–ª–æ–µ**

---

### **3.13.1. –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ MasterDeal Service**

**Operational MasterDeal Service** –≤—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–∞–≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ **–±–∏–∑–Ω–µ—Å-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏, –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤** –º–µ–∂–¥—É –¥–æ–º–µ–Ω–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.

–ï—Å–ª–∏ **Integration Platform** –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è,
—Ç–æ **MasterDeal** ‚Äî –∑–∞ **—Å–º—ã—Å–ª–æ–≤—É—é –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤**,
–≤—ã—Å—Ç—É–ø–∞—è –≤ —Ä–æ–ª–∏ *‚Äú—É–º–Ω–æ–≥–æ —Å–ª–æ—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è‚Äù* (Smart Integration Layer).

```mermaid
graph TD
  subgraph IntegrationLayer[Integration Layer]
    IP[Integration Platform<br/>ESB / EDA Bus / API GW]
    MD[Operational MasterDeal Service<br/>Meta-domain / Aggregator]
  end

  subgraph Domains[Domains]
    CRM[CRM]
    MP[MediaPush]
    DOC[Docflow]
    LEG[Legal]
    DCM[Billing]
    TT[Task-Tracker]
  end

  subgraph DataLayer[Data & Analytics Layer]
    DWH[DWH / BI]
    LLM[LLM Service Layer]
  end

  CRM -- events/api --> IP
  MP -- events/api --> IP
  DOC -- events/api --> IP
  LEG -- events/api --> IP
  DCM -- events/api --> IP
  TT -- events/api --> IP

  IP -- routes/events --> MD
  MD -- canonical events --> IP
  MD -- canonical feed --> DWH
  MD -- api/context --> LLM
```

---

### **3.13.2. –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Å–æ—Å—Ç–∞–≤–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è                          | –§—É–Ω–∫—Ü–∏–∏ MasterDeal                                                                | –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Integration Platform                                                             |
| ---------------------------------- | --------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| **–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤**   | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–¥–∏—è–º–∏ —Å–¥–µ–ª–∫–∏, SLA-—Ç–∞–π–º–µ—Ä–∞–º–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ (`stage.gates`)            | Integration Platform –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç –¥–æ–º–µ–Ω–æ–≤, MasterDeal –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ |
| **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è**        | –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ `master_deal_id` –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤            | –®–∏–Ω–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç ‚Äú—Å—ã—Ä—ã–µ‚Äù —Å–æ–±—ã—Ç–∏—è; MasterDeal –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö                             |
| **–ö–∞–Ω–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**             | –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ **–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–π –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏** (`canonical event schema`)            | Integration Platform –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –≤ DWH, BI –∏ LLM                          |
| **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤**   | –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞ —Å–≤—è–∑–µ–π `external_id ‚Üî master_deal_id`                 | API –∏ registry-—Å–µ—Ä–≤–∏—Å—ã Integration Platform –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç —Ä–µ–µ—Å—Ç—Ä –ø—Ä–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏              |
| **–ö–æ–Ω—Ç—Ä–æ–ª—å SLA –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏** | –†–∞—Å—á—ë—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫, –≤—ã—è–≤–ª–µ–Ω–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏–π, –ø—É–±–ª–∏–∫–∞—Ü–∏—è `sla.breached`           | Integration Platform –≤—ã–ø–æ–ª–Ω—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, retries, —ç—Å–∫–∞–ª–∞—Ü–∏–∏                                    |
| **–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (Observability)**  | –í–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ª–æ–≥–æ–≤ –ø–æ `correlation_id`, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ —Å–¥–µ–ª–æ–∫ | Integration Platform –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è                              |
| **AI –∏ Data Integration**          | –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–¥–µ–ª–∫–∏ –¥–ª—è LLM –∏ DWH                        | Integration Platform –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤                       |

---

### **3.13.3. –ú–µ—Å—Ç–æ –≤ –æ–±—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è**

**Integration Platform** –∏ **MasterDeal Service** –æ–±—Ä–∞–∑—É—é—Ç **–¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å**:

| –£—Ä–æ–≤–µ–Ω—å                                            | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                                                 | –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã                                                           |
| -------------------------------------------------- | ------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------- |
| **1. –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (Integration Platform)** | –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é, –∞–¥–∞–ø—Ç–∞—Ü–∏—é –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π.                    | Kafka, API Gateway, ESB, Event Router, Monitoring, Security                   |
| **2. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å (MasterDeal Layer)**    | –§–æ—Ä–º–∏—Ä—É–µ—Ç –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É —Å–¥–µ–ª–æ–∫, –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è, —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç–∞–¥–∏—è–º–∏ –∏ SLA. | MasterDeal Service, Canonical Model, Event Normalizer, SLA Engine, Aggregator |

üî∏ –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **MasterDeal Service ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏–π**,
–∞ **—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è**, –ø—Ä–µ–≤—Ä–∞—â–∞—é—â–µ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —à–∏–Ω—É –≤ **–±–∏–∑–Ω–µ—Å-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.**

---

### **3.13.4. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Integration Platform**

#### **Inbound –ø–æ—Ç–æ–∫**

* Integration Platform –ø–µ—Ä–µ–¥–∞—ë—Ç —Å—ã—Ä—ã–µ –¥–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ CRM, Media, Docflow, Legal, Billing.
* MasterDeal Service –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –∏—Ö –∏–∑ —Ç–æ–ø–∏–∫–æ–≤ (`crm.*`, `media.*`, `docflow.*`, –∏ —Ç.–¥.).
* –ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ **Event Normalizer**, –≥–¥–µ:

    * –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–∏–ø (`created`, `ready`, `signed`, `issued`);
    * –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∫–ª—é—á (`external_id`);
    * –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è `master_deal_id`.

#### **Outbound –ø–æ—Ç–æ–∫**

* –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ MasterDeal –ø—É–±–ª–∏–∫—É–µ—Ç **–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è** (`masterdeal.stage.changed`, `masterdeal.sla.breached`).
* Integration Platform –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –∏—Ö –≤ **DWH**, **LLM Layer**, **Monitoring**, **Notification services**.

#### **–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã (REST / GraphQL)**

* –ß–µ—Ä–µ–∑ API-—à–ª—é–∑ Integration Platform –∫ MasterDeal –æ–±—Ä–∞—â–∞—é—Ç—Å—è:

    * CRM ‚Äî –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–¥–µ–ª–∫–∏;
    * Docflow ‚Äî –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞;
    * LLM Layer ‚Äî –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–¥–µ–ª–∫–∏ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–µ–¥–∏–∞–ø–ª–∞–Ω–æ–≤ –∏–ª–∏ –ö–ü.

---

### **3.13.5. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –º–æ–¥–µ–ª—å MasterDeal –≤ —Å–æ—Å—Ç–∞–≤–µ Integration Layer**

```mermaid
graph TB
  classDef box fill:#f8fafc,stroke:#334155,stroke-width:1px,rx:4,ry:4
  subgraph MD[Operational MasterDeal Service]
    IN[Event Consumer / Normalizer]:::box
    AGG[Stage Aggregator / SLA Engine]:::box
    REG[ID Registry / Link Table]:::box
    PUB[Event Publisher / Canonical Mapper]:::box
    API[REST / GraphQL API Layer]:::box
    DB[(MasterDeal DB)]:::box
  end

  subgraph IP[Integration Platform]
    BUS[Kafka / ESB Bus]
    GW[API Gateway]
  end

  BUS --> IN
  IN --> AGG
  AGG --> PUB
  AGG --> DB
  REG --> AGG
  PUB --> BUS
  API --> GW
  DB --> API
```

---

### **3.13.6. –ü–æ–ª—å–∑–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞**

| –ê—Å–ø–µ–∫—Ç                          | –î–æ MasterDeal                            | –ü–æ—Å–ª–µ MasterDeal                              |
| ------------------------------- | ---------------------------------------- | --------------------------------------------- |
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏**   | –¢–æ—á–∫–∞-—Ç–æ—á–∫–∞, –Ω–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É | –ï–¥–∏–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ MasterDeal              |
| **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–¥–µ–ª–∫–∏** | –†–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã                     | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `aggregated_stage`           |
| **–ö–æ–Ω—Ç—Ä–æ–ª—å SLA**                | –†–∞–∑–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã –≤ –¥–æ–º–µ–Ω–∞—Ö                 | –ï–¥–∏–Ω—ã–π SLA Engine –≤ MasterDeal                |
| **–§–æ—Ä–º–∞—Ç—ã —Å–æ–±—ã—Ç–∏–π**             | –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ                          | –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å —Å–æ–±—ã—Ç–∏–π                   |
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI/BI**          | –¢—Ä–µ–±—É–µ—Ç –∞–¥–∞–ø—Ç–µ—Ä–æ–≤                        | –ï–¥–∏–Ω–æ–µ API –∏ —Å–æ–±—ã—Ç–∏–π–Ω—ã–π –ø–æ—Ç–æ–∫                 |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**            | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ —Å–≤—è–∑—è–º–∏ –¥–æ–º–µ–Ω–æ–≤               | –®–∏–Ω–∞ + MasterDeal –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç loose coupling |

---

# **3.14. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è MasterDeal Service**

---

## **3.14.1. –¶–µ–ª—å**

–ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç **–∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å** —Ä–∞–±–æ—Ç—ã **Operational MasterDeal Service**,
–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Å–∫–≤–æ–∑–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å SLA –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

MasterDeal —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ‚Äî **—Å–∫–≤–æ–∑–Ω–æ–≥–æ Sales Pipeline**,
–ø–æ—ç—Ç–æ–º—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –ú–¢–°.

---

## **3.14.2. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

| –ü—Ä–∏–Ω—Ü–∏–ø                             | –û–ø–∏—Å–∞–Ω–∏–µ                                                                    | –¶–µ–ª—å                                                        |
| ----------------------------------- | --------------------------------------------------------------------------- | ----------------------------------------------------------- |
| **Event-Sourcing + CQRS**           | –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ —Å–æ–±—ã—Ç–∏—è; —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å —Ä–∞–∑–¥–µ–ª–µ–Ω—ã. | –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏, –∞—É–¥–∏—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏. |
| **Idempotent-by-Design**            | –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.                          | –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –¥—É–±–ª–∏–∫–∞—Ç–∞–º –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π.   |
| **Eventually Consistent**           | –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏.               | –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é.                       |
| **Stateless Application Layer**     | –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏.                       | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ fault tolerance.                         |
| **Loose Coupling & API-first**      | –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ REST/GraphQL –∏ —Å–æ–±—ã—Ç–∏—è.            | –ì–∏–±–∫–æ—Å—Ç—å –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –¥–æ–º–µ–Ω–æ–≤.                        |
| **Observability & Telemetry-first** | –ú–µ—Ç—Ä–∏–∫–∏, –ª–æ–≥–∏ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–æ–±—ã—Ç–∏–π.                              | –ö–æ–Ω—Ç—Ä–æ–ª—å SLA –∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞.                     |
| **Security by Design**              | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π.                | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.        |

---

## **3.14.3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

| –ü–∞—Ä–∞–º–µ—Ç—Ä                                        | –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ                | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                                               |
| ----------------------------------------------- | ------------------------------- | --------------------------------------------------------- |
| **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (Availability)**                  | ‚â• 99.9%                         | –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (HA Cluster)               |
| **–í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ API**                           | ‚â§ 300 –º—Å (p95)                  | –¥–ª—è `GET /masterdeal/{id}` –∏ `PATCH /stage`               |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π**                           | ‚â• 10k —Å–æ–±—ã—Ç–∏–π/–º–∏–Ω               | –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ Kafka —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º |
| **–í—Ä–µ–º—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ stage**                       | ‚â§ 5 —Å–µ–∫ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è | SLA –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–∫–≤–æ–∑–Ω–æ–≥–æ pipeline                           |
| **–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π** | ‚â§ 10 —Å–µ–∫                        | –¥–ª—è `masterdeal.stage.changed`                            |
| **–í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ—è**             | ‚â§ 15 –º–∏–Ω                        | warm standby + state replay                               |
| **–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π (retention)**           | ‚â• 90 –¥–Ω–µ–π                       | –¥–ª—è –∞—É–¥–∏—Ç–∞ –∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏                         |

---

## **3.14.4. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö**

MasterDeal —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ **eventual consistency**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

1. –°–æ–±—ã—Ç–∏—è –º–æ–≥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –∏ –ø–æ—Ä—è–¥–∫–µ.
2. –°–µ—Ä–≤–∏—Å –æ–±—è–∑–∞–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç** –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø–æ—Ä—è–¥–∫–∞ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏.
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** (PostgreSQL / ClickHouse) —Å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ (`version_id`).
4. –í—Å–µ –¥–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è `event_id` –∏ `correlation_id` –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏.
5. –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥—É–±–ª–∏–∫–∞—Ç–∞ `event_id` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è soft-ignore –±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.
6. –í —Å–ª—É—á–∞–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–æ–º–µ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **retry —Å exponential backoff** —á–µ—Ä–µ–∑ Integration Platform.

---

## **3.14.5. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç           | –ú–µ—Ö–∞–Ω–∏–∑–º –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏       | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                               |
| ------------------- | --------------------------------- | ---------------------------------------- |
| **API Layer**       | Load Balancer + AutoScaling Group | –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤           |
| **Event Consumer**  | Consumer Groups (Kafka)           | –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (at-least-once) |
| **Storage (DB)**    | Master-Replica / Multi-AZ         | —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö             |
| **SLA Engine**      | Stateless + Persisted Timers      | –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–π–º–µ—Ä–æ–≤ –ø–æ—Å–ª–µ —Å–±–æ—è    |
| **Event Publisher** | Transactional Outbox / Debezium   | –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –≤ —Ç–æ—á–Ω–æ-–æ–¥–Ω–æ–º —Ä–µ–∂–∏–º–µ  |
| **Monitoring**      | Prometheus + Grafana + Loki       | —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–æ–≤                      |
| **Alerting**        | OpsGenie / PagerDuty              | —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ SLA, –æ—Ç–∫–∞–∑–∞–º, –∑–∞–¥–µ—Ä–∂–∫–∞–º   |

---

## **3.14.6. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏ (Observability)**

**MasterDeal Service** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞–±–ª—é–¥–∞–µ–º—ã–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ç—Ä–∏ –≤–∏–¥–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏:

1. **Metrics (Prometheus):**

    * –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π –ø–æ —Ç–∏–ø—É (`event_type`, `source_system`);
    * –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏;
    * –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤;
    * SLA timers (lead‚Üíplan, contract‚Üílaunch).

2. **Logs (Loki / ELK):**

    * —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å `master_deal_id`, `event_id`, `correlation_id`;
    * —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ `stage.changed`.

3. **Traces (Jaeger / OpenTelemetry):**

    * —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ —Ü–µ–ø–æ—á–µ–∫ —Å–æ–±—ã—Ç–∏–π across domains;
    * –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É–∑–∫–∏—Ö –º–µ—Å—Ç –ø–æ latency.

```mermaid
graph LR
  EV[(Events Kafka)] --> MD[MasterDeal Service]
  MD --> M[Metrics]
  MD --> L[Logs]
  MD --> T[Traces]
  M --> G[Grafana Dashboard]
  L --> ELK[Elastic / Loki]
  T --> J[Jaeger UI]
```

---

## **3.14.7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º**

| –ö–æ–Ω—Ç—É—Ä                 | –ú–µ—Ö–∞–Ω–∏–∑–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏                                         |
| ---------------------- | -------------------------------------------------------------- |
| **API Security**       | OAuth 2.0 / JWT; –ø–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤; –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ IP; RBAC     |
| **Event Security**     | –ü–æ–¥–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π; –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ö–µ–º (Schema Registry)          |
| **Data Protection**    | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–æ–∫–æ–µ (AES-256) –∏ –≤ –ø–æ–ª—ë—Ç–µ (TLS 1.3)              |
| **Audit & Compliance** | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–∏—Å—Ç–µ–º; —Ö—Ä–∞–Ω–µ–Ω–∏–µ 180 –¥–Ω–µ–π |
| **Access Control**     | –°–µ–≥—Ä–µ–≥–∞—Ü–∏—è –ø—Ä–∞–≤ –ø–æ —Ä–æ–ª—è–º: `reader`, `publisher`, `admin`       |
| **PII Handling**       | –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –≤ DWH/BI         |

---

## **3.14.8. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ**

**Deployment Model:**

* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è: `Docker` / `Kubernetes (k8s)`
* CI/CD: `GitLab CI`, `ArgoCD`
* –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: `Helm Charts`
* Observability: `OpenTelemetry`, `Prometheus Operator`

**Horizontal Scaling:**

* AutoScale –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–æ–±—â–µ–Ω–∏–π Kafka.
* API-–ø—É–ª—ã –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç Event Consumers.

**Vertical Scaling:**

* SLA Engine –∏ Aggregator –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –ø–æ CPU/Memory –ø—Ä–∏ –ø–∏–∫–∞—Ö.

**Fault Domains:**

* –ú–∏–Ω–∏–º—É–º 2 –∑–æ–Ω—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (AZ) –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ–±–ª–∞–∫–∞ –ú–¢–°.

---

## **3.14.9. –£–ø—Ä–∞–≤–ª—è–µ–º–æ—Å—Ç—å –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è**

* –í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ –æ–ø–∏—Å–∞–Ω—ã –≤ –≤–∏–¥–µ **Architecture-as-Code** (`/infra/`, `/deploy/`, `/config/`).
* –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API –∏ —Å—Ö–µ–º —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ **Semantic Versioning**.
* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ SLA –∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å—Ç–∞–¥–∏–π.
* –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:

    * —Å—Ö–µ–º—ã ER –∏ sequence;
    * –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã API (OpenAPI);
    * –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–æ–±—ã—Ç–∏–π (AsyncAPI);
    * —á–µ–∫-–ª–∏—Å—Ç—ã SLA –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

---


## **3.15. –ò—Ç–æ–≥ –ø–æ —Ä–∞–∑–¥–µ–ª—É**

–ú–∞—Å—Ç–µ—Ä-—Å–¥–µ–ª–∫–∞ ‚Äî —ç—Ç–æ **—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**,
–∫–æ—Ç–æ—Ä—ã–π –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç CRM, MediaPush, Docflow, Legal, DCM –∏ –¥—Ä—É–≥–∏–µ –¥–æ–º–µ–Ω—ã –≤ —Å–∫–≤–æ–∑–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å.

**Operational MasterDeal Service** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

* –µ–¥–∏–Ω—É—é –±–∏–∑–Ω–µ—Å-–∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Å–¥–µ–ª–∫–∏;
* –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —Å–∫–≤–æ–∑–Ω–æ–π SLA;
* –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ AI-—Å–µ—Ä–≤–∏—Å–∞–º–∏.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **MasterDeal** —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **‚Äú—Ü–∏—Ñ—Ä–æ–≤—ã–º —è–¥—Ä–æ–º —Å–¥–µ–ª–∫–∏‚Äù**,
–≥–¥–µ —Å—Ö–æ–¥—è—Ç—Å—è –≤—Å–µ –¥–æ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ—è—Ç—Å—è –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏.
–ü—Ä–∏ —ç—Ç–æ–º —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å **MasterDeal** —á–∞—Å—Ç—å—é **–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è**

* **–°—ã—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è** –æ—Ç—Ä–∞–∂–∞—é—Ç —Ñ–∞–∫—Ç—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ–º–µ–Ω–∞.
* **–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è MasterDeal** ‚Äî –µ–¥–∏–Ω—ã–π —è–∑—ã–∫ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π.
* –¢–∞–∫–∞—è –º–æ–¥–µ–ª—å –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç MasterDeal –≤ **‚Äú—Ü–µ–Ω—Ç—Ä —Å–æ–±—ã—Ç–∏–π–Ω–æ–π –∏—Å—Ç–∏–Ω—ã‚Äù**,
  –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞–¥–∏–π, SLA –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫.


**MasterDeal Service** —è–≤–ª—è–µ—Ç—Å—è **—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è**,
–æ—Ç–≤–µ—á–∞—é—â–∏–º –Ω–µ –∑–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –∞ –∑–∞ **–±–∏–∑–Ω–µ—Å-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é**.

–û–Ω:

* –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—ã—Ä—ã–µ –¥–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è,
* —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏—Ö –≤ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ,
* —Ö—Ä–∞–Ω–∏—Ç —Å–≤—è–∑–∏ –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞–¥–∏–∏,
* —É–ø—Ä–∞–≤–ª—è–µ—Ç SLA,
* –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π API –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è LLM, BI –∏ CRM.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–ª–æ–π** –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –∏–∑ *‚Äú—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —à–∏–Ω—ã‚Äù* –≤ **‚Äú–±–∏–∑–Ω–µ—Å-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä‚Äù**,
–≥–¥–µ MasterDeal ‚Äî —ç—Ç–æ **—Å–º—ã—Å–ª–æ–≤–æ–µ —è–¥—Ä–æ**, —Å–≤—è–∑—ã–≤–∞—é—â–µ–µ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ –µ–¥–∏–Ω—É—é –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–¥–µ–ª–∫—É.

–ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ **MasterDeal Service** –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç:

* **–≤—ã—Å–æ–∫—É—é –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å** (99.9% uptime),
* **—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º –∏ –¥—É–±–ª–∏–∫–∞—Ç–∞–º**,
* **–ø—Ä–æ–∑—Ä–∞—á–Ω—É—é –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å** –ø—Ä–æ—Ü–µ—Å—Å–æ–≤,
* **–≥–∏–±–∫–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è**,
* **–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç—å** –¥–∞–Ω–Ω—ã—Ö.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, MasterDeal —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ –∑—Ä–µ–ª—ã–º —Å–µ—Ä–≤–∏—Å–æ–º –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è**,
—Å–ø–æ—Å–æ–±–Ω—ã–º –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–æ–ª—å —Ü–µ–Ω—Ç—Ä–∞ –±–∏–∑–Ω–µ—Å-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∞–≤–¥—ã
–≤ —Å–∫–≤–æ–∑–Ω–æ–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ adTech –ú–¢–° Stream.